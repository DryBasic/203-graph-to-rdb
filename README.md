# GraphToRDB Demo

Please refer to `demo.ipynb` for an interactive demo of the graph transformer package using data from neo4j's demo movie database.

Note that while the recommended usage is to treat the package as a simple object with your relational output as an attribute, 
several utilities can be accessed for "non-standard" workflows. One such example being the schema validation utilities. The `demo.ipynb` goes over other potential utilities in greater detail.

### Getting Started
Download the GraphToRDB directory and reference it as an import within your project as done in the demo notebook. Dependencies/requirements are listed in the `pyproject.toml`. They are also listed in the first cell of `demo.ipynb`.

The `example_map.yml` may be helpful to use as a template when writing your own configs. The `example_data.json` file represents the JSON exports generated by [neo4j's APOC export utility](https://neo4j.com/labs/apoc/4.1/export/json/). JSON that does not match this schema will raise exceptions.  

**Requirements**
* Python versions >= 3.10 (uses `match case` statements and `:=` operator)
* Packages: schema, pyyaml

**Your Inputs**
* A valid mapping config
    - takes `.yml` files or a dictionary
* Data in a valid JSON schema
    - takes a `.json` lines file

**Supported Outputs**
* In-memory relational tables (can write to SQL db with your own engine)
* CSV files for each table specified in the mapping
* Barebones SQL CREATE statements to initialize the db from a SQL console

### Notes on Mapping Config Schema
* The intention is that each node and edge type results in its own table.
* For relationship tables, there is no need to specify the from and to node ids as properties/fkeys. This mapping will be done automatically.
* The schema allows for relationships without properties, but not for nodes without properties.
* You **cannot use** the following reserved names for your columns: "id", "from_id", and "to_id"
* The mapping schema allows only for the following datatype input strings (case-insensitive):
    - "string" or "str" or "text" -> str (SQL: TEXT)
    - "int" or "integer" -> int (SQL: INTEGER)
    - "float" or "numeric" -> float (SQL: NUMERIC)
    - "list" or "array" -> list (SQL: TEXT ARRAY)

### TLDR

For simple workflows:
```
import GraphToRDB as g2r

obj = g2r.Transformer(data="my_jsonlines.json", mapping="my_config.yml")
obj.write_to_csv(write_to_directory="my_output_directory")
```

